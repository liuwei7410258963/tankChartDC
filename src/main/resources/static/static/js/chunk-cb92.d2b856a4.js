(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-cb92"],{"6Pgt":function(t,e,a){t.exports=a.p+"static/img/echarts-inv.7b4ec32.png"},"94jo":function(t,e,a){"use strict";var i=a("n8di");a.n(i).a},CNPQ:function(t,e,a){t.exports=a.p+"static/img/up.68cb816.png"},HpZb:function(t,e,a){t.exports=a.p+"static/img/smooth.887f386.png"},PidX:function(t,e,a){"use strict";a.r(e);var i=a("m1cH"),n=a.n(i),r=a("P2sY"),l=a.n(r),o=a("XINx"),s=a("kLUD"),c=a("7Qib"),u=a("6Pgt"),m=a.n(u),p=a("Slh4"),d=a.n(p),h=a("CNPQ"),g=a.n(h),b=a("vdFn"),v=a.n(b),f=a("iDwv"),T=a.n(f),w=a("HpZb"),y=a.n(w),_=a("X4fA"),x={name:"CycleDetail",directives:{elDragDialog:o.a},data:function(){return{dialogValObjVisible:!1,timeDes:"",tableData:[],getQuery:{tankNo:"",startTime:"",endTime:""},timeArr:["",""],invTip:m.a,groupTip:d.a,up:g.a,down:v.a,wave:T.a,smooth:y.a,multipleSelection:[],selectRows:[],idList:[],traceRate:0,groupRate:0,disRate:0,detailChart:"",oilExpansionRate:0,username:"admin"}},mounted:function(){this.username=Object(_.b)()},methods:{getData:function(t){var e=this;this.tableData=[],this.timeDes=0,this.getQuery=l()({},t),this.dialogValObjVisible=!0;var a={tankNo:this.getQuery.tankNo,startTime:Object(c.h)(this.getQuery.startTime,"-",this.timeDes),endTime:Object(c.h)(this.getQuery.endTime,"+",this.timeDes),flag:!1};Object(s.b)(a,"get").then(function(t){e.oilExpansionRate=t.list[0].oilExpansionRate,e.tableData=t.list,e.idList=e.tableData.map(function(t){return t.id}),e.$nextTick(function(){e.$refs.multipleTable.clearSelection(),e.tableData.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t,!0)}),e.handleChartsData(e.multipleSelection.reverse())})})},toAnotherPage:function(t){switch(t){case"back":this.$router.push({name:"ReturnCansPage"});break;case"trace":this.$router.push({name:"Combination"});break;case"group":this.$router.push({name:"PayOil"})}this.dialogValObjVisible=!1,this.$emit("closeAllDia")},getRelByTime:function(){var t=this;this.selectRows=[].concat(this.multipleSelection);var e={flag:!1,tankNo:this.getQuery.tankNo,startTime:Object(c.h)(this.getQuery.startTime,"-",this.timeDes),endTime:Object(c.h)(this.getQuery.endTime,"+",this.timeDes)};Object(s.b)(e,"get").then(function(e){t.tableData=e.list,t.$refs.multipleTable.clearSelection(),t.$nextTick(function(){t.selectRows.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(t.tableData.find(function(t){return e.id===t.id}),!0)})})})},handleChartsData:function(t){for(var e=this,a=[],i=[],n=0;n<t.length;n++)i.push(t[n].trace.startTime,t[n].trace.endTime,t[n].outGroup.startTime,t[n].outGroup.endTime);var r=Object(c.b)(i.sort(function(t,e){return t<e?1:-1}).reverse());this.timeArr=[].concat(r[0],r[r.length-1]),t.reverse().forEach(function(t,e){var i=r.map(function(t){return""}),n=r.map(function(t){return""});r.forEach(function(e,a){e===t.outGroup.startTime&&(i[a]=t.outGroup.volume),e===t.outGroup.endTime&&(i[a]=t.outGroup.volume),e===t.trace.startTime&&(n[a]=t.trace.startVolume),e===t.trace.endTime&&(n[a]=t.trace.endVolume)}),a.push({name:"液位组"+(e+1),type:"line",symbol:"circle",areaStyle:{color:"#314554"},lineStyle:{color:"#314554"},itemStyle:{color:"#314554"},connectNulls:!0,data:n},{name:"付油组"+(e+1),type:"line",areaStyle:{color:"#c23531"},lineStyle:{color:"#c23531"},itemStyle:{color:"#c23531"},connectNulls:!0,yAxisIndex:1,data:i})}),this.$nextTick(function(){e.initCharts(r,a)})},initCharts:function(t,e){this.detailChart&&(this.detailChart.clear(),this.detailChart.dispose()),this.detailChart=this.$echarts.init(document.getElementById("relaCharts"));var a=this,i={legend:{data:["液位组","付油组"]},grid:{left:"3%",bottom:"3%",right:"5%",containLabel:!0},tooltip:{trigger:"item",formatter:function(t){var e=a.multipleSelection[Math.floor(t.seriesIndex/2)],i="";return i+="液位组:<br>"+e.trace.startTime+"~"+e.trace.endTime+"<br>高度变化:"+e.leaveReduce+"&nbsp;&nbsp;&nbsp;&nbsp;体积变化:"+e.volumeReduce,i+="<hr>付油组:<br>"+e.outGroup.startTime+"~"+e.outGroup.endTime+"<br>付出量:"+e.outGroup.volume}},xAxis:{type:"category",name:"时间",data:t},yAxis:[{type:"value",name:"液位组体积(L)"},{type:"value",name:"付油组体积(L)"}],series:e};a.detailChart.setOption(i,!0),window.onresize=function(){a.detailChart.resize()&&a.detailChart.resize()}},handleSelectionChange:function(t,e){t=t.filter(function(t){return void 0!==t}),this.multipleSelection=[].concat(n()(t)),this.handleChartsData(this.multipleSelection),this.getRate(t)},getRate:function(t){var e=this;if(0===t.length)this.traceRate=0,this.groupRate=0,this.disRate=0;else{var a=0,i=t.map(function(t){return t.startTimeAdd=t.trace.startTime,t});(i=i.sort(this.compare)).forEach(function(t,n){var r=0;r=0===n?t.outGroup.volume+t.trace.startVolume*(t.trace.startTemperature-t.trace.endTemperature)*e.oilExpansionRate-(t.backToTank?t.backToTank.trueVolume:0):t.outGroup.volume+i[n-1].trace.endVolume*(i[n-1].trace.endTemperature-t.trace.endTemperature)*e.oilExpansionRate-(t.backToTank?t.backToTank.trueVolume:0),a+=Number(r.toFixed(3))}),this.traceRate=((i[0].trace.startVolume-i[i.length-1].trace.endVolume)/(i[0].trace.startLevel-i[i.length-1].trace.endLevel)).toFixed(3),this.groupRate=(a/(i[0].trace.startLevel-i[i.length-1].trace.endLevel)).toFixed(3),this.disRate=(this.groupRate-this.traceRate).toFixed(3)}},rowClass:function(t){var e=t.row;t.rowIndex;return-1!==this.idList.indexOf(e.id)?"range-stripe":""},compare:function(t,e){return new Date(t.startTimeAdd).getTime()-new Date(e.startTimeAdd).getTime()}}},C=(a("dJYJ"),a("94jo"),a("KHd+")),S=Object(C.a)(x,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{ref:"popMap",attrs:{id:"dialog",visible:t.dialogValObjVisible,modal:!0,"close-on-click-modal":!0,top:"5vh",title:"付油组与液位组关联关系",width:"1200px"},on:{"update:visible":function(e){t.dialogValObjVisible=e}}},[a("div",{attrs:{id:"dialogContainer"}},["admin"===t.username?a("div",{staticStyle:{margin:"5px 0",float:"right"}},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){t.toAnotherPage("back")}}},[t._v("\n        确认回罐\n      ")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.toAnotherPage("trace")}}},[t._v("\n        确认液位组\n      ")]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){t.toAnotherPage("group")}}},[t._v("\n        确认付油组\n      ")])],1):t._e(),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("el-card",{staticClass:"box-card cardHead"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{staticClass:"detail-span",attrs:{span:15}},[a("span",{staticClass:"topFont"},[t._v("付油组毫米变化率:"+t._s(t.groupRate))]),t._v("\n               \n            "),a("span",{staticClass:"topFont"},[t._v("液位组毫米变化率:"+t._s(t.traceRate))]),t._v("\n               \n            "),a("span",{staticClass:"topFont"},[t._v("毫米变化率差值(付油组-液位组):"+t._s(t.disRate))])]),t._v(" "),a("el-col",{attrs:{span:9}},[a("span",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[a("div",{attrs:{id:"tips"}}),t._v(" 关联液位组   \n              前后\n              "),a("el-input",{staticStyle:{display:"inline-block",width:"60px"},attrs:{size:"mini"},model:{value:t.timeDes,callback:function(e){t.timeDes=e},expression:"timeDes"}}),t._v("\n              分钟轨迹\n              "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.getRelByTime}},[t._v("\n                查询\n              ")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"text item card-body"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{id:"trace-table","row-style":{height:"20px"},"cell-style":{padding:"0"},data:t.tableData,"row-class-name":t.rowClass,height:"380"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"25"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"付油组信息"}},[a("el-table-column",{attrs:{align:"center",prop:"outGroup.volume",label:"付油量","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"outGroup.startTime",align:"center",label:"开始时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"outGroup.endTime",align:"center",label:"结束时间",width:"120"}})],1),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"液位组信息"}},[a("el-table-column",{attrs:{fixed:"right",label:"状态",width:"35"},scopedSlots:t._u([{key:"default",fn:function(e){return["LEVEL_STABLE"===e.row.trace.levelState?a("img",{staticStyle:{"margin-left":"7px"},attrs:{src:t.smooth,alt:""}}):"LEVEL_DESCENDING"===e.row.trace.levelState?a("img",{staticStyle:{"margin-left":"7px"},attrs:{src:t.down,alt:""}}):"LEVEL_ASCENDING"===e.row.trace.levelState?a("img",{staticStyle:{"margin-left":"7px"},attrs:{src:t.up,alt:""}}):a("img",{staticStyle:{"margin-left":"7px"},attrs:{src:t.wave,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"开始"}},[a("el-table-column",{attrs:{prop:"trace.startTime",align:"center",label:"时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.startLevel",align:"center",label:"液位","min-width":"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.startVolume",align:"center",label:"体积","min-width":"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.startTemperature",align:"center",label:"温度","min-width":"40"}})],1),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"结束"}},[a("el-table-column",{attrs:{prop:"trace.endTime",align:"center",label:"时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.endLevel",align:"center",label:"液位","min-width":"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.endVolume",align:"center",label:"体积","min-width":"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"trace.endTemperature",align:"center",label:"温度","min-width":"40"}})],1),t._v(" "),a("el-table-column",{attrs:{prop:"leaveReduce",align:"center",label:"液位变化量","min-width":"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"volumeReduce",align:"center",label:"体积变化量","min-width":"70"}})],1)],1)],1)]),t._v(" "),a("div",{staticStyle:{width:"1170px"},attrs:{id:"relaCharts"}}),t._v(" "),a("div",{staticClass:"tips"},[a("div",{staticClass:"range"},[t._v("\n        时间区间:  "+t._s(t.timeArr[0])+" ~ "+t._s(t.timeArr[1])+"\n      ")]),t._v(" "),a("div",{staticClass:"legend"},[a("img",{attrs:{src:t.invTip,alt:""}}),t._v("\n        付油组\n        "),a("img",{attrs:{src:t.groupTip,alt:""}}),t._v("\n        液位组\n      ")])])],1)])},[],!1,null,"3a7a4648",null);S.options.__file="index.vue";e.default=S.exports},Slh4:function(t,e,a){t.exports=a.p+"static/img/echarts-group.4b99156.png"},dIXL:function(t,e,a){},dJYJ:function(t,e,a){"use strict";var i=a("dIXL");a.n(i).a},iDwv:function(t,e,a){t.exports=a.p+"static/img/wave.4ec44df.png"},kLUD:function(t,e,a){"use strict";a.d(e,"c",function(){return n}),a.d(e,"a",function(){return r}),a.d(e,"b",function(){return l});var i=a("t3Un");function n(t,e){return"get"===e?Object(i.a)({url:"/traceRelOutGroup",method:e,params:t}):Object(i.a)({url:"/traceRelOutGroup",method:e,data:t})}function r(t){return Object(i.a)({url:"/dispenser/group/nozlist",method:"get",params:t})}function l(t){return Object(i.a)({url:"/correcting/traceRelOutGroup",method:"get",params:t})}},n8di:function(t,e,a){},vdFn:function(t,e,a){t.exports=a.p+"static/img/down.f750aa4.png"}}]);